# Offline mirrors and indexes

## Creating a PNDA Mirror

To generate all the required mirrors needed during PNDA provisioning:

```sh
sudo su
./create_mirror.sh
```

## Conents of Mirror

Six types of mirror are created:
 - deb: packages that are installed with apt-get when provisioning PNDA on Ubuntu
 - rpm: packages that are installed with yum when provisioning PNDA on Redhat
 - python: packages that are installed with pip
 - miscellaneous: zipped archives for software installed directly
 - CDH repo for CDH: parcels for installing CDH
 - CDH repo for Anaconda: parcels for installing Anaconda on CDH

The deb packages are only generated by create_mirror.sh when it runs on Ubuntu and the rpms are only generated when it runs on Redhat Enterprise Linux. For this reason, create_mirror.sh should be run on the same Operating System type as PNDA will be deployed using. In addition, in order that create_mirror.sh obtains the correct set of dependencies for the image that PNDA will be deployed on, create_mirror.sh **must** be run on a **clean instance** of the **same image** that PNDA will be deployed on.

## Hosting the Mirror

Each of these is written to a folder `mirror-dist/mirror_<type>` which should be placed on an HTTP server, as described [here](../../CREATING_PNDA.md#create-mirror).

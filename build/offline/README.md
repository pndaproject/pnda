# PNDA Mirror 
Use these tools to download the 3rd party dependencies that PNDA uses during the orchestration process. 

## Quick Start

To simply run the entire mirror creation process -

```sh
sudo su
./create_mirror.sh
```

The deb packages are only generated by create_mirror.sh when it runs on Ubuntu and the rpms are only generated when it runs on Redhat Enterprise Linux. For this reason, create_mirror.sh should be run on the same Operating System type as PNDA will be deployed using. In addition, in order that create_mirror.sh obtains the correct set of dependencies for the image that PNDA will be deployed on, create_mirror.sh **must** be run on a **clean instance** of the **same image** that PNDA will be deployed on.

This takes about 20 minutes to run and the output will be available in a directory named ```mirror-dist```.

## Mirror Modules

The different parts of the mirror can be created separately if required. The scripts to do this are -

```
create_mirror_deb.sh
create_mirror_rpm.sh
create_mirror_misc.sh
create_mirror_python.sh
create_mirror_anaconda.sh
create_mirror_cdh.sh
```

Note that, as above, the deb and rpm scripts are for use on Ubuntu or RHEL hosts respectively.

Each script creates it's output in a directory named for the respective mirror type -

```
mirror_deb
mirror_rpm
mirror_misc
mirror_python
mirror_anaconda
mirror_cloudera
```

## Stage on HTTP server

Create an ordinary HTTP server in the target environment or identify an existing server. The server must have connectivity with the PNDA cluster being provisioned. See [these tips](https://github.com/pndaproject/pnda/blob/develop/build/docs/EXAMPLES.md) for rapidly creating an HTTP server using a number of different approaches.

Next, copy the contents of ```mirror-dist``` to the document root of the HTTP server.

The final directory layout should resemble the following -

```
document-root
│
├── mirror_anaconda
│   ├── Anaconda-4.0.0-el7.parcel
│   ├── etc
│
├── mirror_deb
│   ├── acl_2.2.52-1_amd64.deb
│   ├── etc
│
├── etc

            
```